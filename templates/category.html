{% load i18n %}
{% load static %}
{% get_current_language as LANGUAGE_CODE %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>📂 {% trans "Categorylar" %}</title>
  <link rel="stylesheet" href="{% static 'css/category.css' %}">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>
<body>

  {% if messages %}
  <div id="toast-container" style="position: fixed; top: 20px; right: 20px; z-index: 9999; width: 320px;">
    {% for message in messages %}
      <div 
        class="shadow-lg rounded-xl mb-3 text-white d-flex align-items-center" 
        style="
          padding: 12px 16px;
          {% if message.tags == 'success' %} background:#28a745; 
          {% elif message.tags == 'error' %} background:#dc3545; 
          {% elif message.tags == 'warning' %} background:#ffc107; color:#222;
          {% else %} background:#007bff;
          {% endif %}
        ">
        {% if message.tags == "success" %}
          ✅
        {% elif message.tags == "error" %}
          ❌
        {% elif message.tags == "warning" %}
          ⚠️
        {% else %}
          ℹ️
        {% endif %}
        <span class="ms-2">{{ message }}</span>
      </div>
    {% endfor %}
  </div>
{% endif %}

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">💰 Finans</div>
    <nav>
      <a href="{% url "dashboard" %}"><i class='bx bx-grid-alt'></i> {% trans "Dashboard" %}</a>
      <a href="{% url "income" %}"><i class='bx bx-money'></i> {% trans "Bugungi kirim" %}</a>
      <a href="{% url "expence" %}" class="active"><i class='bx bx-bar-chart-alt-2'></i> {% trans "Bugungi chiqim" %}</a>
      <a href="{% url "category" %}"><i class='bx bx-category'></i> {% trans "Categorylar" %}</a>
    </nav>
  </aside>

  <!-- Main content -->
  <div class="main-content">
    <a href="{% url "dashboard" %}" class="back-btn"><i class='bx bx-arrow-back'></i> {% trans "Orqaga" %}</a>
    
    <div class="category-container">
      <h1>📂 {% trans "Categorylar" %}</h1>

      <!-- Category qo'shish formasi -->
      <form method="POST" action="">
        {% csrf_token %}
        <div class="input-group">
          <i class='bx bx-text'></i>
          <input type="text" name="name" placeholder="{% trans 'Category nomi' %}" required>
        </div>
        {% comment %} <div class="input-group">
          <i class='bx bx-palette'></i>
          <input type="text" name="icon" placeholder="{% trans 'Icon klassi (bx bx-...)' %}" required>
        </div> {% endcomment %}
        <button type="submit">{% trans "Qo'shish" %}</button>
      </form>

      <!-- Category ro'yxati -->
      <div class="category-list">
        {% for category in categories %}
        <div class="category-card">
          <i class="{{ category.icon }}"></i>
          <span>{{ category.name }}</span>
          {% comment %} <div class="actions">
            <a href="{% url 'edit_category' category.id %}" class="edit-btn"><i class='bx bx-edit'></i></a>
            <a href="{% url 'delete_category' category.id %}" class="delete-btn"><i class='bx bx-trash'></i></a>
          </div> {% endcomment %}
        </div>
        {% empty %}
        <p>{% trans "Hozircha category mavjud emas" %}</p>
        {% endfor %}
      </div>
    </div>
  </div>

</body>
